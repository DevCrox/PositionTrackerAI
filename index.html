<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Squat Coach</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <nav>
        <div class="nav-brand">AI FITNESS COACH</div>
        <div class="nav-links">
            <span id="nav-role" onclick="UI.guestLogin()" style="font-weight: 300; cursor: pointer;">GUEST</span>
            <div id="status-badge" class="status-badge" style="display:none">Offline</div>
        </div>
    </nav>

    <!-- NEW PREMIUM AUTH -->
    <div id="auth-container" class="auth-container glass-panel">
        <h2 id="auth-title" class="auth-title">Welcome Back</h2>

        <!-- Login Form -->
        <form id="login-form" onsubmit="handleLogin(event)">
            <div class="input-group">
                <input type="email" id="login-email" class="auth-input" placeholder="Email Address" required>
            </div>
            <div class="input-group">
                <input type="password" id="login-password" class="auth-input" placeholder="Password" required>
            </div>
            <button type="submit" class="btn-neon">LOGIN</button>
        </form>

        <!-- Signup Form -->
        <form id="signup-form" onsubmit="handleSignup(event)" style="display: none;">
            <div class="input-group">
                <input type="text" id="signup-name" class="auth-input" placeholder="Full Name" required>
            </div>
            <div class="input-group">
                <input type="email" id="signup-email" class="auth-input" placeholder="Email Address" required>
            </div>
            <div class="input-group">
                <input type="password" id="signup-password" class="auth-input" placeholder="Create Password" required>
            </div>
            <div class="input-group">
                <select id="signup-role" class="auth-input">
                    <option value="athlete">I am an Athlete</option>
                    <option value="coach">I am a Coach</option>
                </select>
            </div>
            <button type="submit" class="btn-neon">CREATE ACCOUNT</button>
        </form>

        <p class="auth-toggle">
            <button class="btn-text" id="auth-toggle-btn" onclick="toggleAuthMode()">New here? Create Account</button>
        </p>
    </div>

    <!-- App Content Wrapper -->
    <div id="app-content" style="display: none;">

        <!-- Coach Dashboard -->
        <div id="coach-dashboard" style="display: none;">
            <div class="dashboard-header">
                <h2>Coach Dashboard</h2>
                <div class="add-member-section">
                    <input type="text" id="athlete-code-input" placeholder="Enter Athlete's 6-digit Code" maxlength="6">
                    <button onclick="UI.connectToAthlete()">Add Member</button>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <h3>My Athletes</h3>
                    <div id="athletes-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="card">
                    <h3>Notifications</h3>
                    <div id="notification-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Athlete Dashboard -->
        <div id="athlete-dashboard" style="display: none;">
            <div class="dashboard-header">
                <h2>Welcome Athlete</h2>
            </div>

            <div id="connection-requests" style="display: none;">
                <!-- Connection Alerts -->
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <h3>My Profile</h3>
                    <div class="code-display">
                        <p>Your Connection Code:</p>
                        <h1 id="my-code-display">------</h1>
                    </div>
                    <div id="my-coach-info"></div>
                </div>

                <div class="card action-card">
                    <h3>Start Training</h3>
                    <p>Access AI Coaching for Squats and Pushups</p>
                    <button class="btn-primary" onclick="UI.goToTraining()">Go to Gym üèãÔ∏è</button>
                </div>
            </div>
        </div>

        <!-- Training Area -->
        <div id="exercise-selection" style="display: none;">
            <button class="btn-back" onclick="UI.backToDashboard()">‚Üê Back to Dashboard</button>
            <h2>Select Your Exercise</h2>
            <div class="exercise-buttons">
                <button class="exercise-btn" onclick="startExercise('squat')">
                    <span class="emoji">üèãÔ∏è</span>
                    <span class="name">Squats</span>
                </button>
                <button class="exercise-btn" onclick="startExercise('pushup')">
                    <span class="emoji">üí™</span>
                    <span class="name">Push-ups</span>
                </button>
            </div>
        </div>

        <div id="exercise-container" style="display: none;">
            <button class="btn-back" onclick="UI.backToDashboard()">‚Üê End Session</button>

            <div id="canvas-container">
                <video id="video" playsinline></video>
                <canvas id="canvas"></canvas>
            </div>

            <div id="feedback">Initializing camera...</div>

            <button id="call-coach-btn" onclick="callCoach()">
                üìû Call Coach
            </button>
        </div>

    </div> <!-- End App Content -->

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection@2.1.0"></script>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="db.js"></script>
    <script src="peer_wrapper.js"></script>
    <script src="ui_manager.js"></script>
    <script src="app.js"></script>
    <script>
        // Init UI when ready
        window.addEventListener('DOMContentLoaded', () => {
            UI.init();
        });
    </script>

</body>

</html>